<style>
  .optional{
    background: #61377b;
      color: white;
  }
</style>
<style>
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color:#696969;
  size: 100px;
  color: #ccc;
}


/* Style the buttons that are used to open the tab content */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 10px 25px;
  transition: 0.3s;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid black;
  border-top: none;
}

.h5{
	color:white;
}


.tabcontent {
  animation: fadeEffect 1s; /* Fading effect takes 1 second */
}

/* Go from zero to full opacity */
@keyframes fadeEffect {
  from {opacity: 0;}
  to {opacity: 1;}
}
.btn-group .btn:hover {
	cursor: pointer;
}

</style>

<div class="br-pagetitle">
    <i class="icon ion-man"></i>
    <div>
    <h4>CLIENTS</h4>
    <p style="color:blue;" class="mg-b-0">----</p>
    </div>
</div><!-- d-flex -->
                           
<h6 class="br-section-label" style="margin-top: 10px;">
    Ajouter un Client
</h6>
<form id="form-send" class="js-form-sendavecfile sauvegardededonne {{app.user.hasAccess('client-add')}}" action="{{path('client-add')}}" method="POST" data-toggle="ajax" data-target="monContent" enctype="multipart/form-data">        

    <div class="form-layout form-layout-1">
        <div class="row mg-b-25" style="background-color:; margin-bottom: 0px; color:red;">
            <div class="col-lg-12" align="center">
            <div class="form-group">
                <center> <h4 align="center">Champs Obligatoires</h4></center>
            </div>
            </div>
        </div>
        <div class="row mg-b-25" style="">
            <div class="col-lg-3" style="background-color:#0866c6; color:black;">
                <div class="form-group">
                <label class="form-control-label">Nom: <span class="tx-danger">*</span></label>
                <input class="form-control" type="text" name="nom"  placeholder="Nom" required>
                </div>
            </div><!-- col-4 -->
            <div class="col-lg-3" style="background-color:#0866c6; color:black;" >
                <div class="form-group">
                <label class="form-control-label">Prénom: <span class="tx-danger">*</span></label>
                <input class="form-control" type="text" name="prenom"  placeholder="Prenom" required>
                </div>
            </div><!-- col-4 -->
                <div class="col-lg-3" style="background-color:#0866c6; color:black;">
                <div class="form-group">
                <label class="form-control-label">CNI: <span class="tx-danger">*</span></label>
                <input class="form-control" type="text" name="cni"  placeholder="cni" required>
                </div>
            </div><!-- col-4 -->
            <div class="col-lg-3" style="background-color:#0866c6; color:black;">
                <div class="form-group" >
                    <label class="form-control-label">Genre: <span class="tx-danger">*</span></label>
                    <select class="form-control" name="sex" required>
                    <option label="--choisir--"></option>
    
                        <option value="F">F</option>
                        <option value="M">M</option>
    
                    </select>
                </div>
            </div><!-- col-4 -->
            <div class="row mg-b-25" style="">
                <div class="row row-sm">
                    <div class="col-sm-12 col-xl-12">
                        <div class="col-md mg-t-20 mg-md-t-0">
                            <div class="card bd-0">
                                <div class="card-header bg-dark">
                                <div class="card-header bg-dark">
                                    <ul class="nav nav-tabs nav-tabs-for-dark card-header-tabs">
                                        <li class="nav-item" id="show-champs-optionnels">
                                            <a  class="nav-link bd-0 active pd-y-8" href="#popular2" data-toggle="tab">Champs Optionnels <span id="chevron"> <i class="fa fa-chevron-down"></i></span></a>
                                        </li>
                                    </ul>
                                </div><!-- card-header -->
                                <div id="champs-optionnels" style="background: #61377b; display: none;" class="card-body color-gray-lighter bd bd-t-0 rounded-bottom">    
                                    <div class="tab-content">
                                        <div class="tab-pane active" id="popular2">
                                    
                                            <div class="row row-sm">
                                            
                                                <div class="optional col-lg-4"  >
                                                    <div class="form-group">
                                                    <label class="form-control-label">Date de naissance: <span class="tx-danger"></span></label>
                                                    <input class="form-control" type="date" name="datenaisance"  placeholder="date de naisance">
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                    <div class="form-group">
                                                    <label class="form-control-label">lieux de naissance: <span class="tx-danger"></span></label>
                                                    <input class="form-control" type="text" name="lieunaisance"  placeholder="lieu de  naisance">
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                    <div class="form-group">
                                                    <label class="form-control-label">Etat civil: <span class="tx-danger"></span></label>
                                                        <select class="form-control" name="etatcivil" >
                                                        <option label="--choisir--"></option>
                                        
                                                            <option value="Mariéé">Marié</option>
                                                            <option value="Célibataire">Célibataire</option>
                                        
                                                        </select>                        
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                    <div class="form-group">
                                                    <label class="form-control-label">Profession: <span class="tx-danger"></span></label>
                                                        <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <div class="input-group-text">
                                                            <i class="fas fa-phone tx-16 lh-0 op-6"></i>
                                                            </div>
                                                        </div><!-- input-group-prepend -->
                                                        <input class="form-control" type="text" name="profession"  placeholder="profession">
                                                        </div>
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                    <div class="form-group">
                                                    <label class="form-control-label">Nationalite: <span class="tx-danger"></span></label>
                                                    <input class="form-control" type="text" name="nationalite"  placeholder="nationalite">
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                    <div class="form-group">
                                                    <label class="form-control-label">Téléphone: <span class="tx-danger"></span></label>
                                                        <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <div class="input-group-text">
                                                            <i class="fas fa-phone tx-16 lh-0 op-6"></i>
                                                            </div>
                                                        </div><!-- input-group-prepend -->
                                                        <input class="form-control" type="text" name="phone"  placeholder="phone">
                                                        </div>
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                    <div class="form-group">
                                                    <label class="form-control-label">Addresse: <span class="tx-danger"></span></label>
                                                        <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <div class="input-group-text">
                                                            <i class="fas fa-bed tx-16 lh-0 op-6"></i>
                                                            </div>
                                                        </div><!-- input-group-prepend -->
                                                        <input class="form-control" type="text" name="adresse"  placeholder="adresse">
                                                        </div>
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                    <div class="form-group">
                                                    <label class="form-control-label">Email: <span class="tx-danger"></span></label>
                                                        <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <div class="input-group-text">
                                                            <i class="fas fa-envelope tx-16 lh-0 op-6"></i>
                                                            </div>
                                                        </div><!-- input-group-prepend -->
                                                        <input class="form-control" type="email" name="email"  placeholder="email">
                                                        </div>
                                                    </div>
                                                </div><!-- col-4 -->
                                                <div class="optional col-lg-4">
                                                        <div class="form-group">
                                                                    <label class="col-sm-4 form-control-label" align="">profil:<span class="tx-danger"></span></label>
                                                                        <input type="file" name="photo" id="file-1"
                                                                            class="inputfile" data-caption="files selected" accept=".png, .jpg,.jpeg">
                                                                            <label for="file-1" class="if-outline if-outline-info">
                                                                            <i class="icon ion-ios-upload-outline tx-24"></i>
                                                                            <span>Choisisez la photo de profil</span>
                                                                    </label>
                                                        </div>
                                                </div><!-- col-4 -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-layout-footer mg-t-30">
                                        <button type="submit" id="btn-save-nouveau" class="btn btn-primary mg-r-5">Valider</button>
                                        <button type="reset"  class="btn btn-default mg-r-5">Reinitialiser</button>
                                        {# <button type="button" class="btn btn-secondary" onclick="hide()">Annuler</button> #}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

<script>
    $("#show-champs-optionnels").on('click', function(e){
        e.preventDefault();
        var v = document.getElementById("champs-optionnels");
        if(v.style.display === "none"){
            $("#chevron").empty();
            $("#chevron").html("<i class='fa fa-chevron-up'></i>");
            v.style.display = "block";
        }else{
            $("#chevron").empty();
            $("#chevron").html("<i class='fa fa-chevron-down'></i>");
            v.style.display = "none";
        }
    });
</script>
<script>
    $(document).ready(function () {
        $('#vefificationstatic').show();
        $('#vefificationenable').hide();
        $("#contentaftervalide").hide();
        $(".formelement").hide();


        $( ".typedechambre" ).change(function() {
            $('.tarifdeschambres').find('option').remove();
                $.ajax({
                    url: "/getalltarif?id="+$(this).children("option:selected").val(),
                    type: 'GET',
                }).done(function(data){

                    console.log(data.length);  
                    i=0;
                    while(i<data.length){
                        $('.tarifdeschambres').append('<option value="'+data[i].id+'" >'+data[i].nom+'('+data[i].duree+'heure - '+data[i].prix+'FCFA )'+'</option>');
                        i++;
                    }  
                        
                }).fail(function(error){
                    console.log("no ok");
                });
        });

    });
</script>
<script>
    function checkdisponibilteofroom() {
        $('#vefificationstatic').hide();
        $('#vefificationenable').show();
        $("#contentaftervalide").hide();
        var typechambre=$('.typedechambre').children("option:selected").val();
        //alert($('.typedechambre').children("option:selected").val());
        //alert($('.tarifdeschambres').children("option:selected").val());
        $('.chambres').find('option').remove();
        
        //alert($('#timeat').val());
        $.ajax({
            url: "/getallchambrelibre",
            type: 'POST',
            dataType: 'json',
            data:{"datearrivee": $('#timeat').val(),"typechambre": typechambre,"duree":$('.tarifdeschambres').children("option:selected").val(),
            "quantite":$('#quantiter').val()}
        }).done(function(data){ 
                    $('#vefificationstatic').show();
                    $('#vefificationenable').hide();
                    if(data.length==0){
                        
                            Swal.fire({
                                position: 'top-end',
                                icon: 'error',
                                title: "pas de chambre disponible",
                                showConfirmButton: false,
                                timer: 2000
                            })
                       
                    }else{
                        $("#contentaftervalide").show();
                        i=0;
                        while(i<data.length){
                            $('.chambres').append('<option value="'+data[i].id+'" >'+data[i].numero+'</option>');
                            i++;
                        } 
                    }
                     
                
        }).fail(function(error){
            $('#vefificationstatic').show();
            $('#vefificationenable').hide();
        });
    }
</script>
<script>
$(".js-form-sendallocation").on('submit', function(e) {
    e.preventDefault();
    //////
    var idForm = $(this).attr('id');
    var element = $("#" + idForm + " #btn-save-nouveau");
    element.html('Chargement... <span class="fa fa-spinner fa-pulse"></span>');
    element.attr("disabled", "true");
    //////
    var dataform = $(this).serialize();
    $.ajax({
            url: "/allocationadd",
            type: 'POST',
            dataType: 'json',
            data:dataform
        }).done(function(data){ 
            $("#contentaftervalide").hide();
            element.html('VALIDER');
            element.removeAttr("disabled");
            if(data.success){
                    Swal.fire({
                    title: 'enregistrement terminé',
                    text: "Voulez-vous imprimer la facture ?",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Imprimer'
                    }).then((result) => {
                    if (result.isConfirmed) {
                      window.open("/printrecuallocation?id="+data.id, '_blank');  
                    }
                    })
            }else{
                Swal.fire({
                    position: 'top-end',
                    icon: 'error',
                    title: "problème d'enregistrement !",
                    showConfirmButton: false,
                    timer: 2000
                })
            }
                
        }).fail(function(error){
        });
        element.html('VALIDER');
        element.removeAttr("disabled");
    }) 
</script>


