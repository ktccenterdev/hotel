
 {% extends "reservbase.html.twig" %}
{% block body %}
<style>
.inlineimage {
    max-width: 470px;
    margin-right: 8px;
    margin-left: 10px
}

.images {
    display: inline-block;
    max-width: 98%;
    height: auto;
    width: 22%;
    margin: 1%;
    left: 20px;
    text-align: center
}
</style>


  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
<div class="br-mainpanel"  style="color=red;">






{# 
      <div class="br-pagetitle">
        <i class="tx-92 fas fa-user"></i>
        <div>
          <h1 style="color:black;">RESERVATION</h1>
          <p style="color:blue;" class="mg-b-0">----</p>
        </div>
      </div><!-- d-flex --> #}

<form action="{{path('add-reservationfr')}}" method="post">
<div class="br-pagebody" style="">
        <div class="br-section-wrapper" >
          <h6 class="br-section-label" align="center"></h6>
		    <h3><a href="/"><i class="fas fa-home" aria-hidden="true">Retour a l'acceuil </i></a></h3>
          <h2  align="center" style="color:black;">RESERVER VOTRE CHAMBRE</h2>
     {# <div class="col-lg-12">   #}
								<div class="d-flex justify-content-end" style="padding:5px;">

							 	</div>

        <div class=""  style="padding:10px;" style="color:black;">

                                              {% for message in app.flashes('success') %}
                                                    <div class="alert alert-success">
                                                        {{ message }}
                                                    </div>
                                                {% endfor %}
          <div class="form-layout form-layout-1" style="color:black; background-color:;background-image: url(back.jpg);">

            <div class="row mg-b-25">

              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Title: <span class="tx-danger">*</span></label>
                            <select class="form-control" name="titre" required>
                                          <option label="--staut--"></option>
                                          <option value="Mr.">Mr.</option>
                                          <option value="Mrs.">Mrs.</option>
                                          <option value="Dr.">Dr.</option>
                                          <option value="Miss.">Miss.</option>
                                          <option value="Prov">Prov</option>
                                          <option value="Rev">Rev</option>
                                        
										 
                                    </select>                </div>
              </div><!-- col-4 -->
             
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Nom: <span class="tx-danger">*</span></label>
                  <input class="form-control"  type="text" name="nom"  placeholder="Nom" >
                </div>
              </div><!-- col-4 -->
               <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Prenom: <span class="tx-danger">*</span></label>
                  <input class="form-control"  type="text" name="prenom"  placeholder="Prenom" >
                </div>
              </div><!-- col-4 -->
              
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Email: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fa fa-envelope tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="email" name="email"  placeholder="email" >
                    </div>
                </div>
              </div>
             
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Telephone: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fa fa-phone tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="text" name="phone"  placeholder="phone" >
                    </div>
                </div>
              </div>

              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Date d'arrivée: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fas fa-calendar tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="date" name="datedariver"  placeholder="Date d'arrivée" >
                    </div>
                </div>
              </div>
             
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Date de départ: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fas fa-calendar tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="date" name="datedepart"  placeholder="datedepart" >
                    </div>
                </div>
              </div>

               <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Heure d'arrivée: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fas fa-calendar tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="time" name="heuredariver"  placeholder="Heure d'arrivée" >
                    </div>
                </div>
              </div>
             
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Heure de départ: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fas fa-calendar tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="time" name="heuredepart	"  placeholder="Heure datedepart">
                    </div>
                </div>
              </div>
               


                 
              {# <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Type de chambre: <span class="tx-danger">*</span></label>
                  <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fas fa-crown tx-16 lh-0 op-6"></i>
											  </div>
									  	</div> #}<!-- input-group-prepend -->
                        {# <select class="form-control" name="type_id" >
                      
      
                          <option label="--Type de chambre--"></option>
                             {% for type in types %}
                              <option value="{{type.id}}">{{type.nom}}</option>
                             {% endfor %}
										    </select> #}
                        {# <select name="typebed" class="form-control typedechambre js-select2" data-placeholder="Choose one" style="width: 75%">
                            <option value="0">Sélectionner le type</option>
                            {% for chambre in typchambres %}
                                <option value="{{chambre.id}}">{{chambre.nom}}</option>
                            {% endfor %}
                        </select>
                  </div>
                </div>
              </div><!-- col-4 --> #}
              <div class="col-lg-4">
                  <div class="form-group">
                      <label class="form-control-label">Type de Chambres: <span class="tx-danger">*</span></label>
                      <select name="typebed" class="form-control typedechambre js-select2" data-placeholder="Choose one" style="width: 75%">
                          <option value="0">Sélectionner le type</option>
                          {% for chambre in typchambres %}
                              <option value="{{chambre.id}}">{{chambre.nom}}</option>
                          {% endfor %}
                      </select>
                  </div>
              </div>
             
              <div class="col-lg-4">
                  <div class="form-group">
                      <label class="form-control-label">Durée : <span class="tx-danger">*</span></label>
                      <select name="sejourclient" class="form-control tarifdeschambres js-select2" data-placeholder="Choose one" style="width: 75%">
                              <option value="0">Durée du sejour</option>
                      </select>
                  </div>
              </div>
              <div class="col-lg-4">
                  <div class="form-group">
                      <label class="form-control-label">Quantité <span class="tx-danger">*</span></label>
                      <input value="1" id="quantiter"  class="form-control" type="number" name="qte">
                  </div>
              </div>

              
               {# <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Numero de chambre: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fa fa-number-1 tx-16 lh-0 op-6 " ></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                        <select class="form-control" name="not yet" >
                      
      
                          <option label="--numero de chambre--"></option>
                            {% for chambre in chambres %}
                              <option value="{{chambre.id}}">{{chambre.numero}}</option>
                             {% endfor %}
										    </select>
                    </div>
                </div>
              </div> #}
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Surface: <span class="tx-danger">*</span></label>
                  <input class="form-control" type="text" name="surface"  placeholder="surface">
                  <input class="form-control" type="hidden" name="numero"  placeholder="surface">

                </div>
              </div><!-- col-4 -->
             {#  <div class="col-lg-3">
                <div class="form-group">
                  <label class="form-control-label">Numero de chambre: <span class="tx-danger">*</span></label>
                  <select class="form-control" name="chambre_id" >
                      
      
                          <option label="--numero de chambre--"></option>
                            {% for chambre in chambres %}
                              <option value="{{chambre.id}}">{{chambre.numero}}</option>
                             {% endfor %}
										    </select>
                </div>
              </div><!-- col-4 --> #}
              
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Nombres d'enfants: <span class="tx-danger">*</span></label>
                  <input class="form-control" type="number" name="nbenafant" placeholder="Nombres d'enfants">
                </div>
              </div><!-- col-4 -->
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Nombres d'adultes: <span class="tx-danger">*</span></label>
                  <input class="form-control" type="number" name="nbaldulte"  placeholder="Nombres d'adultes">
                </div>
              </div><!-- col-4 -->
              <div class="col-lg-4">
                <div class="form-group">
                  <label class="form-control-label">Nombres de lits: <span class="tx-danger">*</span></label>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <div class="input-group-text">
                          <i class="fas fa-bed tx-16 lh-0 op-6"></i>
                        </div>
                      </div><!-- input-group-prepend -->
                      <input class="form-control" type="number" name="nblit"  placeholder="Nombres de lits" >
                    </div>
                </div>
              </div>

              <div class="col-lg-8">
                <div class="form-group">
                  <label class="form-control-label">Description: <span class="tx-danger">*</span></label>
                  <textarea class="form-control" type="text" name="description" cols="8" rows="8" placeholder="Description"></textarea>
                </div>
              </div>

             {#  <div class="col-lg-3">
                <div class="form-group">
                  <label class="form-control-label">Montant: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fas fa-calendar tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="number" name="montan"  placeholder="montant" >
                    </div>
                </div>
              </div> #}
             
              {# <div class="col-lg-3">
                <div class="form-group">
                  <label class="form-control-label">Reduction: <span class="tx-danger">*</span></label>
                    <div class="input-group">
										  <div class="input-group-prepend">
											  <div class="input-group-text">
												  <i class="fas fa-calendar tx-16 lh-0 op-6"></i>
											  </div>
									  	</div><!-- input-group-prepend -->
                    <input class="form-control" type="text" name="reduction"  placeholder="Reduction" >
                    </div>
                </div>
              </div> #}

              <div class="col-lg-12" align="right">
                <div class="form-group">
                  <label class="form-control-label">Payements: <span class="tx-danger">*</span></label>
                  <div class="inlineimage"> 
                    <img class="img-responsive images" src="{{asset('paiement/om.png')}}">
                    <img class="img-responsive images" src="{{asset('paiement/momo.jpg')}}">
                  </div>

              </div>
        </div>

             
      </div><!-- row -->
            
             <div class="form-layout-footer mg-t-5">
							                                     
                            <button type="submit"  class="btn btn-success mg-r-5">Enrégistrer</button>
							</div>
              <!-- form-layout-footer -->
          </div><!-- form-layout -->
</form>
{# </div> #}


<script>
    
        $('#vefificationstatic').show();
        $('#vefificationenable').hide();
        $("#contentaftervalide").hide();
        $(".formelement").hide();


        $( ".typedechambre" ).change(function() {
            $('.tarifdeschambres').find('option').remove();
                $.ajax({
                    url: "/getalltarif?id="+$(this).children("option:selected").val(),
                    type: 'GET',
                }).done(function(data){

                    console.log(data.length);  
                    i=0;
                    while(i<data.length){
                        $('.tarifdeschambres').append('<option value="'+data[i].id+'" >'+data[i].nom+'('+data[i].duree+'heure - '+data[i].prix+'FCFA )'+'</option>');
                        i++;
                    }  
                        
                }).fail(function(error){
                    console.log("no ok");
                });
        });

   
</script>
<script>
    function checkdisponibilteofroom() {
        $('#vefificationstatic').hide();
        $('#vefificationenable').show();
        $("#contentaftervalide").hide();
        var typechambre=$('.typedechambre').children("option:selected").val();
        //alert($('.typedechambre').children("option:selected").val());
        //alert($('.tarifdeschambres').children("option:selected").val());
        $('.chambres').find('option').remove();
        
        //alert($('#timeat').val());
        $.ajax({
            url: "/getallchambrelibre",
            type: 'POST',
            dataType: 'json',
            data:{"datearrivee": $('#timeat').val(),"typechambre": typechambre,"duree":$('.tarifdeschambres').children("option:selected").val(),
            "quantite":$('#quantiter').val()}
        }).done(function(data){ 
                    $('#vefificationstatic').show();
                    $('#vefificationenable').hide();
                    if(data.length==0){
                        
                            Swal.fire({
                                position: 'top-end',
                                icon: 'error',
                                title: "pas de chambre disponible",
                                showConfirmButton: false,
                                timer: 2000
                            })
                       
                    }else{
                        $("#contentaftervalide").show();
                        i=0;
                        while(i<data.length){
                            $('.chambres').append('<option value="'+data[i].id+'" >'+data[i].numero+'</option>');
                            i++;
                        } 
                    }
                     
                
        }).fail(function(error){
            $('#vefificationstatic').show();
            $('#vefificationenable').hide();
        });
    }
</script>
<script>
$(".js-form-sendallocation").on('submit', function(e) {
    e.preventDefault();
    //////
    var idForm = $(this).attr('id');
    var element = $("#" + idForm + " #btn-save-nouveau");
    var element2 = $("#" + idForm + " #btn-save-nouveau");
    element.html('Chargement... <span class="fa fa-spinner fa-pulse"></span>');
    element.attr("disabled", "true");
    //////
    var dataform = $(this).serialize();
    $.ajax({
            url: "/allocationadd",
            type: 'POST',
            dataType: 'json',
            data:dataform
        }).done(function(data){ 
            $("#contentaftervalide").hide();
            console.log(idForm);
            console.log(element);
            element2.html('VALIDER');
            element2.attr("disabled", "false");
            if(data.success){
                    Swal.fire({
                    title: 'enregistrement terminer',
                    text: "Voulez vous imprimer la facture ?",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Imprimer'
                    }).then((result) => {
                    if (result.isConfirmed) {
                      window.open("/printrecuallocation?id="+data.id, '_blank');  
                    }
                    })
            }else{
                Swal.fire({
                    position: 'top-end',
                    icon: 'error',
                    title: "problème d'enregistrer !",
                    showConfirmButton: false,
                    timer: 2000
                })
            }
             console.log(data);        
                
        }).fail(function(error){
            console.log("no ok");
        });
}) 
</script>

{#  #}

 {% endblock %}
