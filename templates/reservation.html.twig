{% extends 'intro/basefront.html.twig' %}
{% block stylesheets %}
  <style>
    .inlineimage {
        max-width: 470px;
        margin-right: 8px;
        margin-left: 10px
    }

    .images {
        display: inline-block;
        max-width: 98%;
        height: auto;
        width: 22%;
        margin: 1%;
        left: 20px;
        text-align: center
    }
  </style>


    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
  <div class="br-mainpanel"  style="color=red;">
{% endblock %}

{% block content %}
    <div class="container" style="color:black; background-color:;background-image: url(back.jpg);">
      <div class="row">
        <form action="{{path('add-reservationfr')}}" method="post">
          {% for message in app.flashes('success') %}
              <div class="alert alert-success">
                  {{ message }}
              </div>
          {% endfor %}
          <div>
            {# <div class="form-layout form-layout-1" style="color:black; background-color:;background-image: url(back.jpg);"> #}
              <div class="row">
                <h2  align="center" style="color: blue;">RESERVER VOTRE CHAMBRE</h2>
              </div>
               <div class="row">
                  <div class="col-lg-4">
                    <div class="form-group">
                          <label class="form-control-label" style="color: blue;">Title: <span class="tx-danger">*</span></label>
                          <select class="form-control" name="titre" required>
                              <option label="--staut--"></option>
                              <option value="Mr.">Mr.</option>
                              <option value="Mrs.">Mrs.</option>
                              <option value="Dr.">Dr.</option>
                              <option value="Miss.">Miss.</option>
                              <option value="Prov">Prov</option>
                              <option value="Rev">Rev</option>
                          </select>  
                    </div>
                  </div>
                  <div class="col-lg-4">
                      <div class="form-group">
                        <label class="form-control-label" style="color: blue;">Nom: <span class="tx-danger">*</span></label>
                        <input class="form-control"  type="text" name="nom"  placeholder="Nom" >
                      </div>
                    </div><!-- col-4 -->
                    <div class="col-lg-4">
                      <div class="form-group">
                        <label class="form-control-label" style="color: blue;">Prenom: <span class="tx-danger">*</span></label>
                        <input class="form-control"  type="text" name="prenom"  placeholder="Prenom" >
                      </div>
                    </div><!-- col-4 -->
                </div>
                <div class="row">

                  <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" style="color: blue;" >Telephone: <span class="tx-danger">*</span></label>
                        <input class="form-control" type="text" name="phone"  placeholder="phone" >
                    </div>
                  </div>
                  <div class="col-lg-4">
                    <div class="form-group">
                      <label class="form-control-label" style="color: blue;" >Date d'arrivée: <span class="tx-danger">*</span></label>
                        <input class="form-control" type="date" name="datedariver"  placeholder="Date d'arrivée" >
                    </div>
                  </div>

                  <div class="col-lg-4">
                    <div class="form-group">
                      <label class="form-control-label" style="color: blue;" >Date de départ: <span class="tx-danger">*</span></label>
                          <input class="form-control" type="date" name="datedepart"  placeholder="datedepart" >
                    </div>
                  </div>

                </div>
                <div class="row">
                  <div class="col-lg-4">
                    <div class="form-group">
                      <label class="form-control-label" style="color: blue;">Heure d'arrivée: <span class="tx-danger">*</span></label>
                      <input class="form-control" type="time" name="heuredariver"  placeholder="Heure d'arrivée" >
                    </div>
                  </div>

                  <div class="col-lg-4">
                    <div class="form-group">
                       <label class="form-control-label" style="color: blue;">Heure de départ: <span class="tx-danger">*</span></label>
                       <input class="form-control" type="time" name="heuredepart	"  placeholder="Heure datedepart">
                    </div>
                  </div>

                  <div class="col-lg-4">
                    <div class="form-group">
                       <label class="form-control-label" style="color: blue;">Type de Chambres: <span class="tx-danger">*</span></label>
                       <select name="typebed" class="form-control typedechambre select2" data-placeholder="Choose one">
                          <option value="0">Sélectionner le type</option>
                          {% for chambre in typchambres %}
                              <option value="{{chambre.id}}">{{chambre.nom}}</option>
                          {% endfor %}
                       </select>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-4">
                      <div class="form-group">
                        <label class="form-control-label" style="color: blue;">Durée : <span class="tx-danger">*</span></label>
                        <select name="sejourclient" class="form-control tarifdeschambres select2" data-placeholder="Choose one" style="width: 75%">
                              <option value="0">Durée du sejour</option>
                        </select>
                      </div>
                  </div>
                  <div class="col-lg-4">
                      <div class="form-group">
                        <label class="form-control-label" style="color: blue;">Quantité <span class="tx-danger">*</span></label>
                        <input value="1" id="quantiter"  class="form-control" type="number" name="qte">
                      </div>
                  </div>
                  <div class="col-lg-4">
                      <div class="form-group">
                        <label class="form-control-label" style="color: blue;">Nombres d'enfants: <span class="tx-danger">*</span></label>
                        <input class="form-control" type="number" name="nbenafant" placeholder="Nombres d'enfants">
                      </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-4">
                        <div class="form-group"> 
                          <label class="form-control-label" style="color: blue;">Nombres d'adultes: <span class="tx-danger">*</span></label>
                          <input class="form-control" type="number" name="nbaldulte"  placeholder="Nombres d'adultes">
                        </div>
                  </div>
                  <div class="col-lg-4">
                        <div class="form-group">
                          <label class="form-control-label" style="color: blue;">Nombres de lits: <span class="tx-danger">*</span></label>
                          <input class="form-control" type="number" name="nblit"  placeholder="Nombres de lits" >
                        </div>
                  </div>
                  <div class="col-lg-4">
                    <div class="form-group">
                      <img style="height: 30px;" class="img-responsive images" src="{{asset('paiement/om.png')}}">
                      <img style="height: 30px;" class="img-responsive images" src="{{asset('paiement/momo.jpg')}}">
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-4">
                   
                  </div>
                  <div class="col-lg-4">
                    <button style="width: 100%; margin-top: 20px; margin-bottom: 20px; background-color: blue;" type="submit"  class="btn btn-success btn-lg"><b>Enrégistrer</b></button>
                  </div>
                  <div class="col-lg-4">
                    
                  </div>
                </div>
        </form>
      </div>
    </div>
  </form>
</div>
{% endblock %}

{% block javascripts %}
            <script>
    
        $('#vefificationstatic').show();
        $('#vefificationenable').hide();
        $("#contentaftervalide").hide();
        $(".formelement").hide();


        $( ".typedechambre" ).change(function() {
            $('.tarifdeschambres').find('option').remove();
                $.ajax({
                    url: "/getalltarif?id="+$(this).children("option:selected").val(),
                    type: 'GET',
                }).done(function(data){

                    console.log(data.length);  
                    i=0;
                    while(i<data.length){
                        $('.tarifdeschambres').append('<option value="'+data[i].id+'" >'+data[i].nom+'('+data[i].duree+'heure - '+data[i].prix+'FCFA )'+'</option>');
                        i++;
                    }  
                        
                }).fail(function(error){
                    console.log("no ok");
                });
        });

   
</script>
<script>
    function checkdisponibilteofroom() {
        $('#vefificationstatic').hide();
        $('#vefificationenable').show();
        $("#contentaftervalide").hide();
        var typechambre=$('.typedechambre').children("option:selected").val();
        //alert($('.typedechambre').children("option:selected").val());
        //alert($('.tarifdeschambres').children("option:selected").val());
        $('.chambres').find('option').remove();
        
        //alert($('#timeat').val());
        $.ajax({
            url: "/getallchambrelibre",
            type: 'POST',
            dataType: 'json',
            data:{"datearrivee": $('#timeat').val(),"typechambre": typechambre,"duree":$('.tarifdeschambres').children("option:selected").val(),
            "quantite":$('#quantiter').val()}
        }).done(function(data){ 
                    $('#vefificationstatic').show();
                    $('#vefificationenable').hide();
                    if(data.length==0){
                        
                            Swal.fire({
                                position: 'top-end',
                                icon: 'error',
                                title: "pas de chambre disponible",
                                showConfirmButton: false,
                                timer: 2000
                            })
                       
                    }else{
                        $("#contentaftervalide").show();
                        i=0;
                        while(i<data.length){
                            $('.chambres').append('<option value="'+data[i].id+'" >'+data[i].numero+'</option>');
                            i++;
                        } 
                    }
                     
                
        }).fail(function(error){
            $('#vefificationstatic').show();
            $('#vefificationenable').hide();
        });
    }
</script>
<script>
$(".js-form-sendallocation").on('submit', function(e) {
    e.preventDefault();
    //////
    var idForm = $(this).attr('id');
    var element = $("#" + idForm + " #btn-save-nouveau");
    var element2 = $("#" + idForm + " #btn-save-nouveau");
    element.html('Chargement... <span class="fa fa-spinner fa-pulse"></span>');
    element.attr("disabled", "true");
    //////
    var dataform = $(this).serialize();
    $.ajax({
            url: "/allocationadd",
            type: 'POST',
            dataType: 'json',
            data:dataform
        }).done(function(data){ 
            $("#contentaftervalide").hide();
            console.log(idForm);
            console.log(element);
            element2.html('VALIDER');
            element2.attr("disabled", "false");
            if(data.success){
                    Swal.fire({
                    title: 'enregistrement terminer',
                    text: "Voulez vous imprimer la facture ?",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Imprimer'
                    }).then((result) => {
                    if (result.isConfirmed) {
                      window.open("/printrecuallocation?id="+data.id, '_blank');  
                    }
                    })
            }else{
                Swal.fire({
                    position: 'top-end',
                    icon: 'error',
                    title: "problème d'enregistrer !",
                    showConfirmButton: false,
                    timer: 2000
                })
            }
             console.log(data);        
                
        }).fail(function(error){
            console.log("no ok");
        });
}) 
</script>

{#  #}
    
{% endblock %}